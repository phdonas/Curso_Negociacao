<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atividade 8.2 - Criar Roteiro de Perguntas com IA | ANC</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Source+Sans+Pro:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --azul-principal: #1e3a5f;
            --azul-claro: #2d5a87;
            --vermelho-principal: #c41e3a;
            --verde: #27ae60;
            --verde-claro: #2ecc71;
            --amarelo: #f39c12;
            --roxo: #9b59b6;
            --laranja: #e67e22;
            --cinza-fundo: #f8f9fa;
            --cinza-borda: #dee2e6;
            --branco: #ffffff;
            --texto-escuro: #212529;
            --texto-medio: #495057;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Source Sans Pro', sans-serif;
            background: linear-gradient(135deg, var(--azul-principal) 0%, var(--laranja) 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container { max-width: 950px; margin: 0 auto; }

        .header {
            text-align: center;
            color: var(--branco);
            margin-bottom: 30px;
        }

        .header-badge {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 8px 20px;
            border-radius: 30px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .header h1 {
            font-family: 'Playfair Display', serif;
            font-size: 1.8rem;
            margin-bottom: 10px;
        }

        .header p { opacity: 0.9; font-size: 1rem; }

        /* Progress Steps */
        .progress-steps {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            position: relative;
        }

        .progress-steps::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 10%;
            right: 10%;
            height: 3px;
            background: rgba(255,255,255,0.3);
        }

        .step-indicator {
            text-align: center;
            z-index: 1;
            flex: 1;
        }

        .step-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255,255,255,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 8px;
            color: var(--branco);
            font-weight: 700;
            transition: all 0.3s ease;
        }

        .step-indicator.active .step-circle {
            background: var(--verde);
            transform: scale(1.1);
        }

        .step-indicator.completed .step-circle {
            background: var(--verde);
        }

        .step-label {
            color: rgba(255,255,255,0.7);
            font-size: 0.75rem;
        }

        .step-indicator.active .step-label {
            color: var(--branco);
            font-weight: 600;
        }

        /* Cards */
        .card {
            background: var(--branco);
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            margin-bottom: 20px;
        }

        .card-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.4rem;
            color: var(--azul-principal);
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--cinza-borda);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-title span {
            background: linear-gradient(135deg, var(--laranja), var(--amarelo));
            color: var(--branco);
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
        }

        /* Identifica√ß√£o */
        .identificacao-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .status-salvamento {
            font-size: 0.85rem;
            color: var(--verde);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .status-salvamento.visivel { opacity: 1; }

        /* Form Groups */
        .form-group { margin-bottom: 20px; }

        .form-group label {
            display: block;
            font-weight: 600;
            color: var(--texto-escuro);
            margin-bottom: 8px;
        }

        .form-group .helper {
            font-size: 0.85rem;
            color: var(--texto-medio);
            margin-bottom: 8px;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--cinza-borda);
            border-radius: 10px;
            font-size: 1rem;
            transition: border-color 0.3s;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--laranja);
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        /* Framework Cards */
        .framework-cards {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .framework-card {
            border: 2px solid var(--cinza-borda);
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .framework-card:hover {
            border-color: var(--laranja);
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(230, 126, 34, 0.2);
        }

        .framework-card.selected {
            border-color: var(--laranja);
            background: linear-gradient(135deg, #fef5e7, #fdf2e9);
        }

        .framework-card.selected::after {
            content: '‚úì';
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--verde);
            color: var(--branco);
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
        }

        .framework-name {
            font-family: 'Playfair Display', serif;
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--azul-principal);
            margin-bottom: 5px;
        }

        .framework-desc {
            font-size: 0.9rem;
            color: var(--texto-medio);
            margin-bottom: 10px;
        }

        .framework-ideal {
            font-size: 0.8rem;
            color: var(--laranja);
            font-weight: 600;
        }

        /* Prompt Output */
        .prompt-output {
            background: var(--cinza-fundo);
            border: 2px solid var(--cinza-borda);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            position: relative;
        }

        .prompt-output pre {
            white-space: pre-wrap;
            word-wrap: break-word;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            color: var(--texto-escuro);
            max-height: 400px;
            overflow-y: auto;
        }

        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--laranja);
            color: var(--branco);
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.85rem;
            transition: all 0.3s;
        }

        .copy-btn:hover {
            background: var(--amarelo);
            transform: scale(1.05);
        }

        .copy-btn.copied {
            background: var(--verde);
        }

        /* Checklist */
        .checklist { margin: 20px 0; }

        .checklist-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 15px;
            background: var(--cinza-fundo);
            border-radius: 8px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .checklist-item:hover { background: #ebf5fb; }
        .checklist-item.checked { background: #e8f8f0; }

        .checklist-checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid var(--cinza-borda);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: transparent;
            font-size: 0.9rem;
            transition: all 0.3s;
        }

        .checklist-item.checked .checklist-checkbox {
            background: var(--verde);
            border-color: var(--verde);
            color: var(--branco);
        }

        /* Buttons */
        .btn-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 25px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 14px 30px;
            border: none;
            border-radius: 50px;
            font-family: 'Source Sans Pro', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--laranja), var(--amarelo));
            color: var(--branco);
            box-shadow: 0 4px 15px rgba(230, 126, 34, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(230, 126, 34, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--verde), var(--verde-claro));
            color: var(--branco);
            box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3);
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(39, 174, 96, 0.4);
        }

        .btn-secondary {
            background: var(--branco);
            color: var(--texto-medio);
            border: 2px solid var(--cinza-borda);
        }

        .btn-secondary:hover {
            background: var(--cinza-fundo);
        }

        /* Step Content */
        .step-content { display: none; }
        .step-content.active { display: block; animation: fadeIn 0.4s ease; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Result */
        .result-score {
            text-align: center;
            padding: 30px;
            background: linear-gradient(135deg, var(--cinza-fundo), #e8f4fd);
            border-radius: 16px;
            margin-bottom: 25px;
        }

        .result-score h2 {
            font-family: 'Playfair Display', serif;
            color: var(--azul-principal);
            margin-bottom: 10px;
        }

        .score-value {
            font-size: 4rem;
            font-weight: 700;
            color: var(--verde);
        }

        .score-label {
            font-size: 1.2rem;
            color: var(--texto-medio);
        }

        .result-message {
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            text-align: center;
        }

        .result-message.excellent { background: #d4edda; color: #155724; }
        .result-message.good { background: #fff3cd; color: #856404; }
        .result-message.needs-work { background: #f8d7da; color: #721c24; }

        .criteria-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .criteria-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            background: var(--branco);
            border-radius: 8px;
            border: 1px solid var(--cinza-borda);
        }

        .criteria-score {
            font-weight: 700;
            padding: 4px 12px;
            border-radius: 20px;
        }

        .criteria-score.full { background: #d4edda; color: #155724; }
        .criteria-score.partial { background: #fff3cd; color: #856404; }
        .criteria-score.zero { background: #f8d7da; color: #721c24; }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-overlay.active { display: flex; }

        .modal {
            background: var(--branco);
            border-radius: 16px;
            max-width: 700px;
            width: 90%;
            max-height: 80vh;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .modal-header {
            background: linear-gradient(135deg, var(--azul-principal), var(--azul-claro));
            color: var(--branco);
            padding: 20px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            font-family: 'Playfair Display', serif;
            font-size: 1.3rem;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--branco);
            font-size: 1.5rem;
            cursor: pointer;
        }

        .modal-body {
            padding: 25px;
            max-height: 50vh;
            overflow-y: auto;
        }

        .modal-body textarea {
            width: 100%;
            min-height: 300px;
            padding: 15px;
            border: 2px solid var(--cinza-borda);
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
        }

        .modal-footer {
            padding: 20px 25px;
            background: var(--cinza-fundo);
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .btn-copiar { background: var(--verde); color: var(--branco); }
        .btn-download { background: var(--azul-principal); color: var(--branco); }

        /* Footer */
        .footer {
            text-align: center;
            color: rgba(255,255,255,0.8);
            padding: 30px 20px;
            font-size: 0.9rem;
        }

        /* Print */
        @media print {
            @page { size: A4; margin: 10mm; }
            body { background: white !important; padding: 0; }
            .header, .progress-steps, .btn-group, .footer, .modal-overlay { display: none !important; }
            .card { box-shadow: none; border: 1px solid var(--cinza-borda); }
            .print-info { display: block !important; }
        }

        .print-info { display: none; text-align: center; font-size: 8pt; margin-top: 20px; }

        /* Responsive */
        @media (max-width: 768px) {
            .form-row, .framework-cards, .criteria-grid { grid-template-columns: 1fr; }
            .btn-group { flex-direction: column; }
            .header h1 { font-size: 1.5rem; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-badge">Atividade Pr√°tica 8.2</div>
            <h1>üéØ Criar Roteiro de Perguntas com IA</h1>
            <p>Use intelig√™ncia artificial para criar roteiros personalizados</p>
        </div>

        <!-- Progress Steps -->
        <div class="progress-steps">
            <div class="step-indicator active" id="stepInd1">
                <div class="step-circle">1</div>
                <div class="step-label">Negocia√ß√£o</div>
            </div>
            <div class="step-indicator" id="stepInd2">
                <div class="step-circle">2</div>
                <div class="step-label">Framework</div>
            </div>
            <div class="step-indicator" id="stepInd3">
                <div class="step-circle">3</div>
                <div class="step-label">Prompt IA</div>
            </div>
            <div class="step-indicator" id="stepInd4">
                <div class="step-circle">4</div>
                <div class="step-label">Resultado</div>
            </div>
            <div class="step-indicator" id="stepInd5">
                <div class="step-circle">5</div>
                <div class="step-label">Finalizar</div>
            </div>
        </div>

        <!-- STEP 1: Identifica√ß√£o -->
        <div class="step-content active" id="step1">
            <div class="card">
                <div class="identificacao-header">
                    <div class="card-title"><span>1</span> Defina a Negocia√ß√£o</div>
                    <span class="status-salvamento" id="statusSalvamento">üíæ Salvo automaticamente</span>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Nome da Negocia√ß√£o</label>
                        <input type="text" id="negName" placeholder="Ex: Projeto CRM para Empresa ABC">
                    </div>
                    <div class="form-group">
                        <label>Valor Estimado</label>
                        <select id="negValue">
                            <option value="">Selecione...</option>
                            <option value="pequeno">At√© R$ 10.000</option>
                            <option value="medio">R$ 10.000 - R$ 100.000</option>
                            <option value="grande">R$ 100.000 - R$ 500.000</option>
                            <option value="enterprise">Acima de R$ 500.000</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label>Situa√ß√£o Atual</label>
                    <div class="helper">Descreva o contexto da negocia√ß√£o em detalhes</div>
                    <textarea id="negSituation" placeholder="Ex: Cliente atual em fase de renova√ß√£o de contrato. Usam nossa solu√ß√£o h√° 2 anos. Concorr√™ncia est√° oferecendo pre√ßos agressivos..."></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Ciclo de Vendas</label>
                        <select id="negCycle">
                            <option value="">Selecione...</option>
                            <option value="curto">Curto (at√© 30 dias)</option>
                            <option value="medio">M√©dio (1-3 meses)</option>
                            <option value="longo">Longo (3-6 meses)</option>
                            <option value="enterprise">Enterprise (6+ meses)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Est√°gio no Funil</label>
                        <select id="negStage">
                            <option value="">Selecione...</option>
                            <option value="qualificacao">Qualifica√ß√£o inicial</option>
                            <option value="descoberta">Descoberta de necessidades</option>
                            <option value="proposta">Apresenta√ß√£o de proposta</option>
                            <option value="negociacao">Negocia√ß√£o final</option>
                        </select>
                    </div>
                </div>

                <div class="btn-group">
                    <button class="btn btn-primary" onclick="goToStep(2)">Pr√≥ximo: Escolher Framework ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- STEP 2: Framework -->
        <div class="step-content" id="step2">
            <div class="card">
                <div class="card-title"><span>2</span> Escolha o Framework de Perguntas</div>

                <div class="framework-cards">
                    <div class="framework-card" data-framework="SPIN" onclick="selectFramework(this)">
                        <div class="framework-name">SPIN Selling</div>
                        <div class="framework-desc">Situa√ß√£o ‚Üí Problema ‚Üí Implica√ß√£o ‚Üí Necessidade-Payoff</div>
                        <div class="framework-ideal">Ideal para: Vendas consultivas B2B</div>
                    </div>
                    <div class="framework-card" data-framework="BANT" onclick="selectFramework(this)">
                        <div class="framework-name">BANT</div>
                        <div class="framework-desc">Budget ‚Üí Authority ‚Üí Need ‚Üí Timeline</div>
                        <div class="framework-ideal">Ideal para: Qualifica√ß√£o r√°pida</div>
                    </div>
                    <div class="framework-card" data-framework="SNAP" onclick="selectFramework(this)">
                        <div class="framework-name">SNAP Selling</div>
                        <div class="framework-desc">Simple ‚Üí iNvaluable ‚Üí Align ‚Üí Priority</div>
                        <div class="framework-ideal">Ideal para: Decisores ocupados</div>
                    </div>
                    <div class="framework-card" data-framework="MEDDIC" onclick="selectFramework(this)">
                        <div class="framework-name">MEDDIC</div>
                        <div class="framework-desc">Metrics ‚Üí Economic Buyer ‚Üí Decision ‚Üí Criteria ‚Üí Identify ‚Üí Champion</div>
                        <div class="framework-ideal">Ideal para: Vendas enterprise complexas</div>
                    </div>
                </div>

                <div class="form-group">
                    <label>Por que voc√™ escolheu este framework?</label>
                    <textarea id="frameworkJustification" placeholder="Explique brevemente por que este framework √© adequado para sua situa√ß√£o..."></textarea>
                </div>

                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="goToStep(1)">‚Üê Voltar</button>
                    <button class="btn btn-primary" onclick="goToStep(3)">Pr√≥ximo: Gerar Prompt ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- STEP 3: Prompt IA -->
        <div class="step-content" id="step3">
            <div class="card">
                <div class="card-title"><span>3</span> Contexto para o Prompt de IA</div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Sua Empresa/Solu√ß√£o</label>
                        <textarea id="yourCompany" placeholder="Descreva sua empresa e o que voc√™ vende..."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Empresa do Cliente</label>
                        <textarea id="clientCompany" placeholder="Descreva a empresa do cliente (setor, porte, etc.)..."></textarea>
                    </div>
                </div>

                <div class="form-group">
                    <label>Desafios/Dores Conhecidos do Cliente</label>
                    <textarea id="clientChallenges" placeholder="O que voc√™ j√° sabe sobre os problemas dele?"></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Contexto da Reuni√£o</label>
                        <select id="meetingContext">
                            <option value="">Selecione...</option>
                            <option value="primeira">Primeira reuni√£o</option>
                            <option value="followup">Follow-up</option>
                            <option value="proposta">Apresenta√ß√£o de proposta</option>
                            <option value="fechamento">Reuni√£o de fechamento</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Concorrentes no Processo</label>
                        <input type="text" id="competitors" placeholder="Ex: Empresa X, Empresa Y">
                    </div>
                </div>

                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="goToStep(2)">‚Üê Voltar</button>
                    <button class="btn btn-primary" onclick="generatePrompt()">ü§ñ Gerar Prompt de IA</button>
                </div>

                <div class="prompt-output" id="promptOutput" style="display: none;">
                    <button class="copy-btn" onclick="copyPrompt()">üìã Copiar Prompt</button>
                    <pre id="generatedPrompt"></pre>
                </div>

                <div class="btn-group" id="afterPromptBtns" style="display: none;">
                    <button class="btn btn-success" onclick="goToStep(4)">Pr√≥ximo: Registrar Resultado ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- STEP 4: Resultado da IA -->
        <div class="step-content" id="step4">
            <div class="card">
                <div class="card-title"><span>4</span> Registre o Resultado da IA</div>

                <div class="form-group">
                    <label>Cole aqui o roteiro gerado pela IA</label>
                    <div class="helper">Use ChatGPT, Claude ou outra IA com o prompt gerado</div>
                    <textarea id="aiResult" style="min-height: 200px;" placeholder="Cole aqui as perguntas geradas pela IA..."></textarea>
                </div>

                <div class="form-group">
                    <label>‚úÖ Checklist de Valida√ß√£o</label>
                    <div class="checklist">
                        <div class="checklist-item" onclick="toggleCheck(this)">
                            <div class="checklist-checkbox">‚úì</div>
                            <span>As perguntas s√£o abertas (n√£o sim/n√£o)</span>
                        </div>
                        <div class="checklist-item" onclick="toggleCheck(this)">
                            <div class="checklist-checkbox">‚úì</div>
                            <span>Seguem a sequ√™ncia l√≥gica do framework</span>
                        </div>
                        <div class="checklist-item" onclick="toggleCheck(this)">
                            <div class="checklist-checkbox">‚úì</div>
                            <span>S√£o espec√≠ficas para o contexto do cliente</span>
                        </div>
                        <div class="checklist-item" onclick="toggleCheck(this)">
                            <div class="checklist-checkbox">‚úì</div>
                            <span>Tom adequado para o n√≠vel do interlocutor</span>
                        </div>
                        <div class="checklist-item" onclick="toggleCheck(this)">
                            <div class="checklist-checkbox">‚úì</div>
                            <span>Ajudam a descobrir dores e necessidades</span>
                        </div>
                        <div class="checklist-item" onclick="toggleCheck(this)">
                            <div class="checklist-checkbox">‚úì</div>
                            <span>Conduzem naturalmente para sua solu√ß√£o</span>
                        </div>
                        <div class="checklist-item" onclick="toggleCheck(this)">
                            <div class="checklist-checkbox">‚úì</div>
                            <span>Posso memorizar/adaptar facilmente</span>
                        </div>
                    </div>
                </div>

                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="goToStep(3)">‚Üê Voltar</button>
                    <button class="btn btn-primary" onclick="goToStep(5)">Pr√≥ximo: Finalizar ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- STEP 5: Finaliza√ß√£o -->
        <div class="step-content" id="step5">
            <div class="card">
                <div class="card-title"><span>5</span> Finalize seu Roteiro</div>

                <div class="form-group">
                    <label>üèÜ Suas TOP 5 Perguntas para a Reuni√£o</label>
                    <div class="helper">Selecione as 5 melhores perguntas do roteiro gerado</div>
                    <textarea id="topQuestions" style="min-height: 150px;" placeholder="1. 
2. 
3. 
4. 
5. "></textarea>
                </div>

                <div class="form-group">
                    <label>üìù Adapta√ß√µes e Notas Pessoais</label>
                    <textarea id="adaptations" placeholder="Anote adapta√ß√µes, varia√ß√µes ou lembretes..."></textarea>
                </div>

                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="goToStep(4)">‚Üê Voltar</button>
                    <button class="btn btn-success" onclick="finishActivity()">‚úÖ Finalizar Atividade</button>
                </div>
            </div>
        </div>

        <!-- STEP Result -->
        <div class="step-content" id="stepResult">
            <div class="card">
                <div class="result-score">
                    <h2>üìä Sua Pontua√ß√£o</h2>
                    <div class="score-value" id="finalScore">0</div>
                    <div class="score-label">de 100 pontos</div>
                </div>

                <div class="result-message" id="resultMessage"></div>

                <h3 style="margin: 20px 0 15px; color: var(--azul-principal);">Detalhamento por Crit√©rio</h3>
                <div class="criteria-grid">
                    <div class="criteria-item">
                        <span>Negocia√ß√£o definida</span>
                        <span class="criteria-score" id="crit1">0/15</span>
                    </div>
                    <div class="criteria-item">
                        <span>Framework justificado</span>
                        <span class="criteria-score" id="crit2">0/20</span>
                    </div>
                    <div class="criteria-item">
                        <span>Contexto detalhado</span>
                        <span class="criteria-score" id="crit3">0/15</span>
                    </div>
                    <div class="criteria-item">
                        <span>Resultado da IA</span>
                        <span class="criteria-score" id="crit4">0/15</span>
                    </div>
                    <div class="criteria-item">
                        <span>Checklist valida√ß√£o</span>
                        <span class="criteria-score" id="crit5">0/15</span>
                    </div>
                    <div class="criteria-item">
                        <span>TOP 5 perguntas</span>
                        <span class="criteria-score" id="crit6">0/15</span>
                    </div>
                    <div class="criteria-item">
                        <span>Adapta√ß√µes</span>
                        <span class="criteria-score" id="crit7">0/5</span>
                    </div>
                </div>

                <div class="btn-group">
                    <button class="btn btn-success" onclick="imprimirPDF()">üñ®Ô∏è Imprimir / PDF</button>
                    <button class="btn btn-success" onclick="abrirModalExportacao()">üì§ Exportar JSON</button>
                    <button class="btn btn-secondary" onclick="resetActivity()">üîÑ Nova Atividade</button>
                </div>
            </div>
        </div>

        <!-- Print Info -->
        <div class="print-info">
            <strong>Negocia√ß√£o para Vendas: M√©todo do Professor</strong><br>
            Prof. Paulo H. Donassolo | Atividade 8.2 - Roteiro de Perguntas<br>
            Gerado em: <span id="print-data"></span>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p><strong>Atividade Pr√°tica | M√≥dulo 8 - Metodologias de Perguntas</strong></p>
            <p>Negocia√ß√£o para Vendas: M√©todo do Professor | Prof. Paulo H. Donassolo</p>
        </div>
    </div>

    <!-- Modal Exporta√ß√£o -->
    <div class="modal-overlay" id="modalExportacao">
        <div class="modal">
            <div class="modal-header">
                <h3>üì§ Exportar Atividade (JSON)</h3>
                <button class="modal-close" onclick="fecharModal()">&times;</button>
            </div>
            <div class="modal-body">
                <p style="margin-bottom: 15px; color: var(--texto-medio);">Copie o conte√∫do ou clique em "Baixar Arquivo".</p>
                <textarea id="jsonOutput" readonly></textarea>
            </div>
            <div class="modal-footer">
                <button class="btn btn-copiar" onclick="copiarJSON()">üìã Copiar</button>
                <button class="btn btn-download" onclick="baixarJSON()">üíæ Baixar</button>
            </div>
        </div>
    </div>

    <script>
        // Estado
        const STORAGE_KEY = 'anc_atividade_8_2_roteiro';
        let currentStep = 1;
        let selectedFramework = null;
        let checkedItems = 0;
        let dadosExportacao = null;

        // Navega√ß√£o
        function goToStep(step) {
            // Valida√ß√£o
            if (step === 2 && !validateStep1()) return;
            if (step === 3 && !selectedFramework) {
                alert('Por favor, selecione um framework.');
                return;
            }

            document.querySelectorAll('.step-content').forEach(el => el.classList.remove('active'));
            document.getElementById(`step${step}`).classList.add('active');

            document.querySelectorAll('.step-indicator').forEach((el, idx) => {
                el.classList.remove('active', 'completed');
                if (idx + 1 < step) el.classList.add('completed');
                if (idx + 1 === step) el.classList.add('active');
            });

            currentStep = step;
            autoSave();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function validateStep1() {
            const name = document.getElementById('negName').value;
            const situation = document.getElementById('negSituation').value;
            if (!name || !situation) {
                alert('Por favor, preencha o nome e a situa√ß√£o da negocia√ß√£o.');
                return false;
            }
            return true;
        }

        // Framework
        function selectFramework(element) {
            document.querySelectorAll('.framework-card').forEach(c => c.classList.remove('selected'));
            element.classList.add('selected');
            selectedFramework = element.dataset.framework;
            autoSave();
        }

        // Gerar Prompt
        function generatePrompt() {
            const prompt = buildPrompt();
            document.getElementById('generatedPrompt').textContent = prompt;
            document.getElementById('promptOutput').style.display = 'block';
            document.getElementById('afterPromptBtns').style.display = 'flex';
            autoSave();
        }

        function buildPrompt() {
            const negName = document.getElementById('negName').value;
            const negSituation = document.getElementById('negSituation').value;
            const yourCompany = document.getElementById('yourCompany').value;
            const clientCompany = document.getElementById('clientCompany').value;
            const challenges = document.getElementById('clientChallenges').value || 'N√£o identificados ainda';
            const context = document.getElementById('meetingContext').value || 'N√£o especificado';
            const competitors = document.getElementById('competitors').value || 'N√£o identificados';

            const prompts = {
                SPIN: `Voc√™ √© um especialista em vendas consultivas com 20 anos de experi√™ncia. Preciso que voc√™ crie um roteiro de perguntas usando a metodologia SPIN Selling.

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
CONTEXTO DA NEGOCIA√á√ÉO: ${negName}
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

SITUA√á√ÉO ATUAL:
${negSituation}

MINHA EMPRESA/SOLU√á√ÉO:
${yourCompany}

EMPRESA DO CLIENTE:
${clientCompany}

DESAFIOS/DORES CONHECIDOS:
${challenges}

CONTEXTO DA REUNI√ÉO:
${context}

CONCORRENTES NO PROCESSO:
${competitors}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
INSTRU√á√ïES
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

Crie um roteiro completo com 4-5 perguntas para cada fase do SPIN:

1. **SITUA√á√ÉO** - Perguntas para entender o cen√°rio atual
2. **PROBLEMA** - Perguntas para identificar dificuldades e dores
3. **IMPLICA√á√ÉO** - Perguntas para amplificar o impacto dos problemas
4. **NECESSIDADE-PAYOFF** - Perguntas para fazer o cliente visualizar a solu√ß√£o

REQUISITOS:
‚úî Perguntas abertas (n√£o sim/n√£o)
‚úî Espec√≠ficas para este contexto
‚úî Tom consultivo e profissional
‚úî Que conduzam naturalmente para minha solu√ß√£o

Por favor, gere o roteiro completo de perguntas SPIN.`,

                BANT: `Voc√™ √© um especialista em qualifica√ß√£o de vendas com 20 anos de experi√™ncia. Preciso que voc√™ crie um roteiro de qualifica√ß√£o usando a metodologia BANT.

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
CONTEXTO DA NEGOCIA√á√ÉO: ${negName}
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

SITUA√á√ÉO ATUAL:
${negSituation}

MINHA EMPRESA/SOLU√á√ÉO:
${yourCompany}

EMPRESA DO CLIENTE:
${clientCompany}

DESAFIOS/DORES CONHECIDOS:
${challenges}

CONTEXTO DA REUNI√ÉO:
${context}

CONCORRENTES NO PROCESSO:
${competitors}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
INSTRU√á√ïES
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

Crie um roteiro de qualifica√ß√£o com 3-4 perguntas para cada elemento:

1. **BUDGET (Or√ßamento)** - Perguntas sobre disponibilidade financeira
2. **AUTHORITY (Autoridade)** - Perguntas para mapear decisores
3. **NEED (Necessidade)** - Perguntas sobre urg√™ncia e prioridade
4. **TIMELINE (Prazo)** - Perguntas sobre cronograma de decis√£o

REQUISITOS:
‚úî Perguntas indiretas e sutis (n√£o parecer interrogat√≥rio)
‚úî Espec√≠ficas para este contexto
‚úî Tom profissional e consultivo

Por favor, gere o roteiro completo de qualifica√ß√£o BANT.`,

                SNAP: `Voc√™ √© um especialista em vendas para executivos ocupados. Preciso que voc√™ crie um roteiro usando a metodologia SNAP Selling.

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
CONTEXTO DA NEGOCIA√á√ÉO: ${negName}
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

SITUA√á√ÉO ATUAL:
${negSituation}

MINHA EMPRESA/SOLU√á√ÉO:
${yourCompany}

EMPRESA DO CLIENTE:
${clientCompany}

DESAFIOS/DORES CONHECIDOS:
${challenges}

CONTEXTO DA REUNI√ÉO:
${context}

CONCORRENTES NO PROCESSO:
${competitors}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
INSTRU√á√ïES
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

Crie um roteiro com 3-4 perguntas para cada princ√≠pio SNAP:

1. **SIMPLE (Simples)** - Como simplificar a decis√£o
2. **iNVALUABLE (Insubstitu√≠vel)** - Como demonstrar valor √∫nico
3. **ALIGN (Alinhado)** - Como alinhar com prioridades do cliente
4. **PRIORITY (Prioridade)** - Como se tornar prioridade

REQUISITOS:
‚úî Perguntas diretas e objetivas
‚úî Respeitem o tempo do executivo
‚úî Foco em valor e resultados r√°pidos

Por favor, gere o roteiro completo SNAP Selling.`,

                MEDDIC: `Voc√™ √© um especialista em vendas enterprise complexas com 20 anos de experi√™ncia. Preciso que voc√™ crie um roteiro de qualifica√ß√£o usando a metodologia MEDDIC.

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
CONTEXTO DA NEGOCIA√á√ÉO: ${negName}
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

SITUA√á√ÉO ATUAL:
${negSituation}

MINHA EMPRESA/SOLU√á√ÉO:
${yourCompany}

EMPRESA DO CLIENTE:
${clientCompany}

DESAFIOS/DORES CONHECIDOS:
${challenges}

CONTEXTO DA REUNI√ÉO:
${context}

CONCORRENTES NO PROCESSO:
${competitors}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
INSTRU√á√ïES
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

Crie um roteiro completo com 3-4 perguntas para cada elemento:

1. **METRICS (M√©tricas)** - KPIs e resultados esperados
2. **ECONOMIC BUYER** - Quem controla o or√ßamento
3. **DECISION CRITERIA** - Crit√©rios de escolha
4. **DECISION PROCESS** - Processo de aprova√ß√£o
5. **IDENTIFY PAIN** - Dor que motiva a compra
6. **CHAMPION** - Defensor interno

REQUISITOS:
‚úî Sofisticadas (apropriadas para vendas enterprise)
‚úî Espec√≠ficas para este contexto
‚úî Tom consultivo e estrat√©gico

Por favor, gere o roteiro completo MEDDIC.`
            };

            return prompts[selectedFramework] || prompts.SPIN;
        }

        function copyPrompt() {
            const prompt = document.getElementById('generatedPrompt').textContent;
            navigator.clipboard.writeText(prompt).then(() => {
                const btn = document.querySelector('.copy-btn');
                btn.textContent = '‚úì Copiado!';
                btn.classList.add('copied');
                setTimeout(() => {
                    btn.textContent = 'üìã Copiar Prompt';
                    btn.classList.remove('copied');
                }, 2000);
            });
        }

        // Checklist
        function toggleCheck(item) {
            item.classList.toggle('checked');
            checkedItems = document.querySelectorAll('.checklist-item.checked').length;
            autoSave();
        }

        // Finalizar
        function finishActivity() {
            if (!document.getElementById('topQuestions').value.trim()) {
                alert('Por favor, liste suas TOP 5 perguntas.');
                return;
            }

            // Calcular pontua√ß√£o
            let crit1 = 0, crit2 = 0, crit3 = 0, crit4 = 0, crit5 = 0, crit6 = 0, crit7 = 0;

            // Crit√©rio 1: Negocia√ß√£o (15)
            const negFields = ['negName', 'negSituation', 'negValue', 'negCycle'];
            const filledNeg = negFields.filter(f => document.getElementById(f).value).length;
            if (filledNeg === 4 && document.getElementById('negSituation').value.length > 50) crit1 = 15;
            else if (filledNeg >= 3) crit1 = 10;
            else if (filledNeg >= 2) crit1 = 5;

            // Crit√©rio 2: Framework (20)
            const just = document.getElementById('frameworkJustification').value;
            if (selectedFramework && just.length > 100) crit2 = 20;
            else if (selectedFramework && just.length > 50) crit2 = 15;
            else if (selectedFramework && just.length > 20) crit2 = 10;
            else if (selectedFramework) crit2 = 5;

            // Crit√©rio 3: Contexto (15)
            const ctxFields = ['yourCompany', 'clientCompany', 'clientChallenges', 'meetingContext'];
            const filledCtx = ctxFields.filter(f => document.getElementById(f).value.length > 30).length;
            crit3 = Math.round((filledCtx / 4) * 15);

            // Crit√©rio 4: Resultado IA (15)
            const aiLen = document.getElementById('aiResult').value.length;
            if (aiLen > 500) crit4 = 15;
            else if (aiLen > 200) crit4 = 10;
            else if (aiLen > 50) crit4 = 5;

            // Crit√©rio 5: Checklist (15)
            crit5 = Math.round((checkedItems / 7) * 15);

            // Crit√©rio 6: TOP 5 (15)
            const topLen = document.getElementById('topQuestions').value.length;
            if (topLen > 200) crit6 = 15;
            else if (topLen > 100) crit6 = 10;
            else if (topLen > 30) crit6 = 5;

            // Crit√©rio 7: Adapta√ß√µes (5)
            const adaptLen = document.getElementById('adaptations').value.length;
            if (adaptLen > 100) crit7 = 5;
            else if (adaptLen > 50) crit7 = 3;
            else if (adaptLen > 10) crit7 = 1;

            const score = crit1 + crit2 + crit3 + crit4 + crit5 + crit6 + crit7;

            // Mostrar resultado
            document.querySelectorAll('.step-content').forEach(el => el.classList.remove('active'));
            document.getElementById('stepResult').classList.add('active');

            document.getElementById('finalScore').textContent = score;

            // Atualizar crit√©rios
            updateCriteria('crit1', crit1, 15);
            updateCriteria('crit2', crit2, 20);
            updateCriteria('crit3', crit3, 15);
            updateCriteria('crit4', crit4, 15);
            updateCriteria('crit5', crit5, 15);
            updateCriteria('crit6', crit6, 15);
            updateCriteria('crit7', crit7, 5);

            // Mensagem
            const msgEl = document.getElementById('resultMessage');
            const scoreEl = document.getElementById('finalScore');

            if (score >= 85) {
                scoreEl.style.color = '#27ae60';
                msgEl.className = 'result-message excellent';
                msgEl.innerHTML = 'üèÜ <strong>Excelente!</strong> Voc√™ criou um roteiro completo e bem fundamentado. Est√° pronto para aplicar!';
            } else if (score >= 65) {
                scoreEl.style.color = '#f39c12';
                msgEl.className = 'result-message good';
                msgEl.innerHTML = 'üëç <strong>Bom trabalho!</strong> Seu roteiro est√° no caminho certo. Considere refinar alguns pontos.';
            } else {
                scoreEl.style.color = '#e74c3c';
                msgEl.className = 'result-message needs-work';
                msgEl.innerHTML = 'üîç <strong>Precisa de mais trabalho.</strong> Revise os crit√©rios com pontua√ß√£o baixa.';
            }

            autoSave();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function updateCriteria(id, value, max) {
            const el = document.getElementById(id);
            el.textContent = `${value}/${max}`;
            if (value === max) el.className = 'criteria-score full';
            else if (value > 0) el.className = 'criteria-score partial';
            else el.className = 'criteria-score zero';
        }

        // Auto-save
        function mostrarStatusSalvamento() {
            const status = document.getElementById('statusSalvamento');
            status.classList.add('visivel');
            setTimeout(() => status.classList.remove('visivel'), 2000);
        }

        function coletarDados() {
            return {
                _meta: { tipo: "atividade_8_2_roteiro_perguntas", versao: "1.0", exportadoEm: new Date().toISOString() },
                negociacao: {
                    nome: document.getElementById('negName').value,
                    situacao: document.getElementById('negSituation').value,
                    valor: document.getElementById('negValue').value,
                    ciclo: document.getElementById('negCycle').value,
                    estagio: document.getElementById('negStage').value
                },
                framework: {
                    selecionado: selectedFramework,
                    justificativa: document.getElementById('frameworkJustification').value
                },
                contexto: {
                    suaEmpresa: document.getElementById('yourCompany').value,
                    clienteEmpresa: document.getElementById('clientCompany').value,
                    desafios: document.getElementById('clientChallenges').value,
                    contextoReuniao: document.getElementById('meetingContext').value,
                    concorrentes: document.getElementById('competitors').value
                },
                resultadoIA: document.getElementById('aiResult').value,
                checklistValidacao: checkedItems,
                topPerguntas: document.getElementById('topQuestions').value,
                adaptacoes: document.getElementById('adaptations').value
            };
        }

        function autoSave() {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(coletarDados()));
            mostrarStatusSalvamento();
        }

        function carregarDados() {
            const saved = localStorage.getItem(STORAGE_KEY);
            if (saved) {
                try {
                    const d = JSON.parse(saved);
                    if (d.negociacao) {
                        if (d.negociacao.nome) document.getElementById('negName').value = d.negociacao.nome;
                        if (d.negociacao.situacao) document.getElementById('negSituation').value = d.negociacao.situacao;
                        if (d.negociacao.valor) document.getElementById('negValue').value = d.negociacao.valor;
                        if (d.negociacao.ciclo) document.getElementById('negCycle').value = d.negociacao.ciclo;
                        if (d.negociacao.estagio) document.getElementById('negStage').value = d.negociacao.estagio;
                    }
                    if (d.framework) {
                        if (d.framework.selecionado) {
                            selectedFramework = d.framework.selecionado;
                            const opt = document.querySelector(`.framework-card[data-framework="${d.framework.selecionado}"]`);
                            if (opt) opt.classList.add('selected');
                        }
                        if (d.framework.justificativa) document.getElementById('frameworkJustification').value = d.framework.justificativa;
                    }
                    if (d.contexto) {
                        if (d.contexto.suaEmpresa) document.getElementById('yourCompany').value = d.contexto.suaEmpresa;
                        if (d.contexto.clienteEmpresa) document.getElementById('clientCompany').value = d.contexto.clienteEmpresa;
                        if (d.contexto.desafios) document.getElementById('clientChallenges').value = d.contexto.desafios;
                        if (d.contexto.contextoReuniao) document.getElementById('meetingContext').value = d.contexto.contextoReuniao;
                        if (d.contexto.concorrentes) document.getElementById('competitors').value = d.contexto.concorrentes;
                    }
                    if (d.resultadoIA) document.getElementById('aiResult').value = d.resultadoIA;
                    if (d.topPerguntas) document.getElementById('topQuestions').value = d.topPerguntas;
                    if (d.adaptacoes) document.getElementById('adaptations').value = d.adaptacoes;
                } catch (e) { console.error('Erro ao carregar:', e); }
            }
        }

        function resetActivity() {
            if (confirm('Tem certeza que deseja come√ßar nova atividade? Todo o progresso ser√° perdido.')) {
                localStorage.removeItem(STORAGE_KEY);
                location.reload();
            }
        }

        // Modal
        function abrirModalExportacao() {
            dadosExportacao = coletarDados();
            document.getElementById('jsonOutput').value = JSON.stringify(dadosExportacao, null, 2);
            document.getElementById('modalExportacao').classList.add('active');
        }

        function fecharModal() { document.getElementById('modalExportacao').classList.remove('active'); }

        function copiarJSON() {
            const textarea = document.getElementById('jsonOutput');
            textarea.select();
            navigator.clipboard.writeText(textarea.value).then(() => alert('JSON copiado!')).catch(() => { document.execCommand('copy'); alert('JSON copiado!'); });
        }

        function baixarJSON() {
            try {
                const blob = new Blob([JSON.stringify(dadosExportacao, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `roteiro_${document.getElementById('negName').value.replace(/\s+/g, '_') || 'perguntas'}_${new Date().toISOString().slice(0,10)}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                fecharModal();
            } catch (err) { alert('Para baixar, copie o conte√∫do e cole em um arquivo .json'); }
        }

        function imprimirPDF() {
            document.getElementById('print-data').textContent = new Date().toLocaleDateString('pt-BR');
            window.print();
        }

        // Eventos
        document.addEventListener('keydown', e => { if (e.key === 'Escape') fecharModal(); });
        document.getElementById('modalExportacao').addEventListener('click', e => { if (e.target === document.getElementById('modalExportacao')) fecharModal(); });

        // Auto-save em todos os inputs
        document.querySelectorAll('input, textarea, select').forEach(el => {
            el.addEventListener('input', autoSave);
            el.addEventListener('change', autoSave);
        });

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', carregarDados);
    </script>
</body>
</html>
