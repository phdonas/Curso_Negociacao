<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atividade 5.1 - Mapear Fontes de Poder | Negocia√ß√£o para Vendas</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Source+Sans+Pro:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --azul-principal: #1e3a5f;
            --azul-claro: #2d5a87;
            --vermelho-principal: #c41e3a;
            --vermelho-claro: #e63946;
            --verde: #28a745;
            --amarelo: #f1c40f;
            --roxo: #8e44ad;
            --roxo-claro: #9b59b6;
            --laranja: #e67e22;
            --cinza-fundo: #f8f9fa;
            --cinza-borda: #dee2e6;
            --branco: #ffffff;
            --texto-escuro: #212529;
            --texto-medio: #495057;
            /* Cores dos pilares */
            --poder: #8e44ad;
            --tempo: #3498db;
            --informacao: #1abc9c;
            --confianca: #f1c40f;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Source Sans Pro', sans-serif;
            background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 50%, #1e3a5f 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
        }

        /* Header */
        .header {
            text-align: center;
            color: var(--branco);
            margin-bottom: 30px;
            padding: 20px;
        }

        .header-badge {
            display: inline-block;
            background: var(--roxo);
            color: var(--branco);
            padding: 8px 20px;
            border-radius: 30px;
            font-size: 0.85rem;
            font-weight: 600;
            letter-spacing: 1px;
            text-transform: uppercase;
            margin-bottom: 15px;
        }

        .header h1 {
            font-family: 'Playfair Display', serif;
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        /* Cards */
        .card {
            background: var(--branco);
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
            margin-bottom: 25px;
        }

        .card-header {
            background: linear-gradient(135deg, var(--roxo), var(--roxo-claro));
            color: var(--branco);
            padding: 20px 25px;
        }

        .card-header h2 {
            font-family: 'Playfair Display', serif;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-body {
            padding: 25px;
        }

        /* Identifica√ß√£o */
        .identificacao {
            background: var(--cinza-fundo);
            padding: 20px 25px;
            border-bottom: 1px solid var(--cinza-borda);
        }

        .identificacao-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .identificacao h3 {
            font-family: 'Playfair Display', serif;
            color: var(--azul-principal);
            font-size: 1.1rem;
        }

        .status-salvamento {
            font-size: 0.85rem;
            color: var(--verde);
            display: flex;
            align-items: center;
            gap: 5px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .status-salvamento.visivel {
            opacity: 1;
        }

        .identificacao-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .campo {
            display: flex;
            flex-direction: column;
        }

        .campo label {
            font-weight: 600;
            color: var(--azul-principal);
            margin-bottom: 5px;
            font-size: 0.9rem;
        }

        .campo input,
        .campo select,
        .campo textarea {
            padding: 10px 12px;
            border: 2px solid var(--cinza-borda);
            border-radius: 8px;
            font-size: 0.95rem;
            font-family: 'Source Sans Pro', sans-serif;
            transition: all 0.3s ease;
        }

        .campo input:focus,
        .campo select:focus,
        .campo textarea:focus {
            outline: none;
            border-color: var(--roxo);
            box-shadow: 0 0 0 3px rgba(142, 68, 173, 0.1);
        }

        .campo-largo {
            grid-column: 1 / -1;
        }

        /* Progress */
        .progress-container {
            background: var(--branco);
            border-radius: 16px;
            padding: 20px 25px;
            margin-bottom: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .progress-title {
            font-weight: 600;
            color: var(--azul-principal);
        }

        .progress-stats {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }

        .stat-badge {
            padding: 4px 12px;
            border-radius: 15px;
            font-weight: 600;
            font-size: 0.85rem;
        }

        .stat-eu { background: #e8f8f5; color: #1abc9c; }
        .stat-cliente { background: #fef9e7; color: #f39c12; }
        .stat-gap { background: #fdedec; color: #e74c3c; }

        .progress-bar {
            height: 10px;
            background: var(--cinza-borda);
            border-radius: 5px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--roxo), var(--roxo-claro));
            border-radius: 5px;
            transition: width 0.5s ease;
            width: 0%;
        }

        /* Intro Box */
        .intro-box {
            background: #f5eef8;
            border-left: 4px solid var(--roxo);
            padding: 20px;
            border-radius: 0 8px 8px 0;
            margin-bottom: 25px;
        }

        .intro-box h3 {
            color: #6c3483;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .intro-box p {
            color: var(--texto-medio);
            line-height: 1.6;
        }

        /* Pilares Reference */
        .pilares-ref {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 25px;
        }

        .pilar-item {
            padding: 15px 10px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid;
            transition: transform 0.2s ease;
        }

        .pilar-item:hover {
            transform: scale(1.03);
        }

        .pilar-item h4 {
            font-size: 0.95rem;
            margin-bottom: 5px;
        }

        .pilar-item p {
            font-size: 0.75rem;
            opacity: 0.9;
        }

        .pilar-poder { background: #f5eef8; color: #6c3483; border-color: var(--roxo); }
        .pilar-tempo { background: #ebf5fb; color: #1a5276; border-color: var(--tempo); }
        .pilar-info { background: #e8f6f3; color: #0e6655; border-color: var(--informacao); }
        .pilar-confianca { background: #fef9e7; color: #9a7d0a; border-color: var(--confianca); }

        /* Context Section */
        .context-section {
            background: var(--cinza-fundo);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
        }

        .context-section h4 {
            color: var(--azul-principal);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            color: var(--texto-escuro);
            margin-bottom: 8px;
            font-size: 0.95rem;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--cinza-borda);
            border-radius: 10px;
            font-size: 1rem;
            font-family: 'Source Sans Pro', sans-serif;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--roxo);
            box-shadow: 0 0 0 3px rgba(142, 68, 173, 0.1);
        }

        .form-group textarea {
            min-height: 80px;
            resize: vertical;
        }

        /* Power Grid */
        .power-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 25px;
        }

        .power-column {
            background: var(--cinza-fundo);
            border-radius: 12px;
            padding: 20px;
        }

        .power-column h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid;
        }

        .power-column.eu-col h3 {
            color: var(--informacao);
            border-color: var(--informacao);
        }

        .power-column.cliente-col h3 {
            color: var(--laranja);
            border-color: var(--laranja);
        }

        /* Power Cards */
        .power-card {
            background: var(--branco);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            border: 2px solid var(--cinza-borda);
            transition: all 0.3s ease;
        }

        .power-card.filled {
            border-color: var(--roxo);
            background: linear-gradient(135deg, #faf8fc, #f5eef8);
        }

        .power-card-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 12px;
        }

        .power-icon {
            font-size: 1.3rem;
        }

        .power-name {
            font-weight: 700;
            color: var(--texto-escuro);
            font-size: 0.95rem;
        }

        .power-desc {
            font-size: 0.8rem;
            color: var(--texto-medio);
        }

        /* Rating Buttons */
        .rating-group {
            display: flex;
            gap: 5px;
        }

        .rating-btn {
            width: 40px;
            height: 40px;
            border: 2px solid var(--cinza-borda);
            border-radius: 8px;
            background: var(--branco);
            cursor: pointer;
            font-weight: 700;
            font-size: 1rem;
            transition: all 0.2s ease;
            color: var(--texto-medio);
        }

        .rating-btn:hover {
            border-color: var(--roxo);
            background: #f5eef8;
        }

        .rating-btn.active {
            background: var(--roxo);
            border-color: var(--roxo);
            color: var(--branco);
        }

        /* Comparison Section */
        .comparison-section {
            background: var(--cinza-fundo);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
        }

        .comparison-section h3 {
            color: var(--azul-principal);
            margin-bottom: 20px;
            font-family: 'Playfair Display', serif;
        }

        .comparison-row {
            display: grid;
            grid-template-columns: 150px 1fr 60px 1fr 60px;
            gap: 10px;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--cinza-borda);
        }

        .comparison-row:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .comparison-label {
            font-weight: 600;
            color: var(--texto-escuro);
            font-size: 0.9rem;
        }

        .bar-container {
            height: 20px;
            background: var(--cinza-borda);
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .bar-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        .bar-fill.eu-bar {
            background: linear-gradient(90deg, #1abc9c, #16a085);
        }

        .bar-fill.cliente-bar {
            background: linear-gradient(90deg, #f39c12, #e67e22);
        }

        .bar-value {
            font-weight: 700;
            text-align: center;
            font-size: 0.9rem;
        }

        .bar-value.eu-val { color: var(--informacao); }
        .bar-value.cliente-val { color: var(--laranja); }

        /* Strategy Section */
        .strategy-section {
            background: linear-gradient(135deg, #fff8e6, #fffbf0);
            border-left: 4px solid var(--amarelo);
            padding: 20px;
            border-radius: 0 12px 12px 0;
            margin-bottom: 20px;
        }

        .strategy-section h4 {
            color: var(--texto-escuro);
            margin-bottom: 15px;
        }

        /* Reflection Box */
        .reflection-box {
            background: linear-gradient(135deg, #f5eef8, #ebe0f5);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .reflection-box h4 {
            color: var(--roxo);
            margin-bottom: 15px;
        }

        .reflection-questions {
            list-style: none;
        }

        .reflection-questions li {
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
            color: var(--texto-escuro);
        }

        .reflection-questions li::before {
            content: "ü§î";
            position: absolute;
            left: 0;
        }

        /* Buttons */
        .btn-group {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 25px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 14px 30px;
            border: none;
            border-radius: 50px;
            font-family: 'Source Sans Pro', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--verde), #2ecc71);
            color: var(--branco);
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
        }

        .btn-secondary {
            background: var(--branco);
            color: var(--vermelho-principal);
            border: 2px solid var(--vermelho-principal);
        }

        .btn-secondary:hover {
            background: var(--vermelho-principal);
            color: var(--branco);
        }

        .btn-export {
            background: linear-gradient(135deg, var(--roxo), var(--roxo-claro));
            color: var(--branco);
            box-shadow: 0 4px 15px rgba(142, 68, 173, 0.3);
        }

        .btn-export:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(142, 68, 173, 0.4);
        }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: var(--branco);
            border-radius: 16px;
            max-width: 700px;
            width: 90%;
            max-height: 80vh;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .modal-header {
            background: linear-gradient(135deg, var(--roxo), var(--roxo-claro));
            color: var(--branco);
            padding: 20px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            font-family: 'Playfair Display', serif;
            font-size: 1.3rem;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--branco);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 5px;
            line-height: 1;
        }

        .modal-body {
            padding: 25px;
            max-height: 50vh;
            overflow-y: auto;
        }

        .modal-body textarea {
            width: 100%;
            min-height: 300px;
            padding: 15px;
            border: 2px solid var(--cinza-borda);
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            resize: vertical;
        }

        .modal-footer {
            padding: 20px 25px;
            background: var(--cinza-fundo);
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .btn-copiar {
            background: var(--verde);
            color: var(--branco);
        }

        .btn-download {
            background: var(--roxo);
            color: var(--branco);
        }

        /* Footer */
        .footer {
            text-align: center;
            color: var(--branco);
            padding: 25px;
            opacity: 0.8;
            font-size: 0.9rem;
        }

        /* Print Styles */
        @media print {
            @page {
                size: A4;
                margin: 12mm;
            }

            body {
                background: white !important;
                padding: 0;
                font-size: 10pt;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }

            .container {
                max-width: 100%;
            }

            .header {
                color: var(--azul-principal) !important;
                padding: 10px;
                margin-bottom: 15px;
            }

            .header h1 {
                font-size: 18pt;
                text-shadow: none;
            }

            .header-badge {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }

            .card {
                box-shadow: none;
                border: 1px solid var(--cinza-borda);
                page-break-inside: avoid;
            }

            .card-header {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }

            .progress-container {
                box-shadow: none;
                border: 1px solid var(--cinza-borda);
            }

            .progress-fill,
            .bar-fill {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }

            .power-card.filled,
            .rating-btn.active {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }

            .pilar-item,
            .stat-badge {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }

            .btn-group,
            .footer,
            .modal-overlay {
                display: none !important;
            }

            .intro-box,
            .strategy-section,
            .reflection-box,
            .comparison-section,
            .context-section {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }

            .print-info {
                display: block !important;
                text-align: center;
                font-size: 9pt;
                color: var(--texto-medio);
                margin-top: 20px;
                padding-top: 15px;
                border-top: 1px solid var(--cinza-borda);
            }
        }

        .print-info {
            display: none;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.6rem;
            }

            .pilares-ref {
                grid-template-columns: repeat(2, 1fr);
            }

            .power-grid {
                grid-template-columns: 1fr;
            }

            .comparison-row {
                grid-template-columns: 1fr;
                gap: 5px;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .btn-group {
                flex-direction: column;
            }

            .identificacao-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-badge">Atividade Pr√°tica 5.1</div>
            <h1>‚ö° Mapear Fontes de Poder</h1>
            <p>Analise as fontes de poder na sua pr√≥xima negocia√ß√£o e desenvolva estrat√©gias</p>
        </div>

        <!-- Progress -->
        <div class="progress-container">
            <div class="progress-header">
                <span class="progress-title">üìä Balan√ßo de Poder</span>
                <div class="progress-stats">
                    <div class="stat-item">
                        <span class="stat-badge stat-eu">Voc√™: <span id="score-eu">0</span></span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-badge stat-cliente">Cliente: <span id="score-cliente">0</span></span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-badge stat-gap">Gap: <span id="score-gap">0</span></span>
                    </div>
                </div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progress"></div>
            </div>
        </div>

        <!-- Card Principal -->
        <div class="card">
            <!-- Identifica√ß√£o -->
            <div class="identificacao">
                <div class="identificacao-header">
                    <h3>üìã Identifica√ß√£o da Negocia√ß√£o</h3>
                    <span class="status-salvamento" id="statusSalvamento">
                        <span>üíæ</span> Salvo automaticamente
                    </span>
                </div>
                <div class="identificacao-grid">
                    <div class="campo">
                        <label for="negociador">Seu Nome</label>
                        <input type="text" id="negociador" placeholder="Seu nome completo">
                    </div>
                    <div class="campo">
                        <label for="cliente">Cliente / Empresa</label>
                        <input type="text" id="cliente" placeholder="Nome do cliente">
                    </div>
                    <div class="campo">
                        <label for="dataNegociacao">Data Prevista</label>
                        <input type="date" id="dataNegociacao">
                    </div>
                    <div class="campo">
                        <label for="valorEstimado">Valor Estimado (R$)</label>
                        <input type="text" id="valorEstimado" placeholder="Ex: 50.000">
                    </div>
                    <div class="campo campo-largo">
                        <label for="contexto">Contexto da Negocia√ß√£o</label>
                        <textarea id="contexto" placeholder="Descreva brevemente o que est√° sendo negociado..."></textarea>
                    </div>
                </div>
            </div>

            <div class="card-body">
                <!-- Intro -->
                <div class="intro-box">
                    <h3>üéØ Objetivo desta Atividade</h3>
                    <p>Analise as <strong>6 fontes de poder</strong> presentes na sua pr√≥xima negocia√ß√£o. Avalie de 1 a 5 o quanto voc√™ e seu cliente possuem cada fonte. Isso vai revelar onde voc√™ tem vantagem e onde precisa se fortalecer.</p>
                </div>

                <!-- Pilares Reference -->
                <h3 style="color: var(--azul-principal); margin-bottom: 15px; font-family: 'Playfair Display', serif;">üìö As 6 Fontes de Poder</h3>
                <div class="pilares-ref">
                    <div class="pilar-item pilar-poder" title="Capacidade de influenciar a negocia√ß√£o">
                        <h4>üéØ Alternativas</h4>
                        <p>MAANA / Plano B</p>
                    </div>
                    <div class="pilar-item pilar-info" title="Dados, insights e conhecimento">
                        <h4>üìä Informa√ß√£o</h4>
                        <p>Conhecimento do contexto</p>
                    </div>
                    <div class="pilar-item pilar-tempo" title="Credibilidade e autoridade">
                        <h4>üèÜ Legitimidade</h4>
                        <p>Credenciais e autoridade</p>
                    </div>
                    <div class="pilar-item pilar-confianca" title="Quem tem mais pressa?">
                        <h4>‚è∞ Urg√™ncia</h4>
                        <p>Press√£o de tempo</p>
                    </div>
                </div>

                <!-- Power Grid -->
                <div class="power-grid">
                    <!-- Coluna EU -->
                    <div class="power-column eu-col">
                        <h3>üë§ SEU PODER</h3>

                        <div class="power-card" id="card-eu-alternativas">
                            <div class="power-card-header">
                                <span class="power-icon">üéØ</span>
                                <div>
                                    <div class="power-name">ALTERNATIVAS</div>
                                    <div class="power-desc">Quantas op√ß√µes voc√™ tem se n√£o fechar?</div>
                                </div>
                            </div>
                            <div class="rating-group">
                                <button class="rating-btn" onclick="setRating('eu', 'alternativas', 1, this)">1</button>
                                <button class="rating-btn" onclick="setRating('eu', 'alternativas', 2, this)">2</button>
                                <button class="rating-btn" onclick="setRating('eu', 'alternativas', 3, this)">3</button>
                                <button class="rating-btn" onclick="setRating('eu', 'alternativas', 4, this)">4</button>
                                <button class="rating-btn" onclick="setRating('eu', 'alternativas', 5, this)">5</button>
                            </div>
                        </div>

                        <div class="power-card" id="card-eu-informacao">
                            <div class="power-card-header">
                                <span class="power-icon">üìä</span>
                                <div>
                                    <div class="power-name">INFORMA√á√ÉO</div>
                                    <div class="power-desc">O quanto voc√™ conhece sobre ele?</div>
                                </div>
                            </div>
                            <div class="rating-group">
                                <button class="rating-btn" onclick="setRating('eu', 'informacao', 1, this)">1</button>
                                <button class="rating-btn" onclick="setRating('eu', 'informacao', 2, this)">2</button>
                                <button class="rating-btn" onclick="setRating('eu', 'informacao', 3, this)">3</button>
                                <button class="rating-btn" onclick="setRating('eu', 'informacao', 4, this)">4</button>
                                <button class="rating-btn" onclick="setRating('eu', 'informacao', 5, this)">5</button>
                            </div>
                        </div>

                        <div class="power-card" id="card-eu-legitimidade">
                            <div class="power-card-header">
                                <span class="power-icon">üèÜ</span>
                                <div>
                                    <div class="power-name">LEGITIMIDADE</div>
                                    <div class="power-desc">Sua credibilidade e autoridade</div>
                                </div>
                            </div>
                            <div class="rating-group">
                                <button class="rating-btn" onclick="setRating('eu', 'legitimidade', 1, this)">1</button>
                                <button class="rating-btn" onclick="setRating('eu', 'legitimidade', 2, this)">2</button>
                                <button class="rating-btn" onclick="setRating('eu', 'legitimidade', 3, this)">3</button>
                                <button class="rating-btn" onclick="setRating('eu', 'legitimidade', 4, this)">4</button>
                                <button class="rating-btn" onclick="setRating('eu', 'legitimidade', 5, this)">5</button>
                            </div>
                        </div>

                        <div class="power-card" id="card-eu-urgencia">
                            <div class="power-card-header">
                                <span class="power-icon">‚è∞</span>
                                <div>
                                    <div class="power-name">URG√äNCIA (invertido)</div>
                                    <div class="power-desc">5 = voc√™ n√£o tem pressa</div>
                                </div>
                            </div>
                            <div class="rating-group">
                                <button class="rating-btn" onclick="setRating('eu', 'urgencia', 1, this)">1</button>
                                <button class="rating-btn" onclick="setRating('eu', 'urgencia', 2, this)">2</button>
                                <button class="rating-btn" onclick="setRating('eu', 'urgencia', 3, this)">3</button>
                                <button class="rating-btn" onclick="setRating('eu', 'urgencia', 4, this)">4</button>
                                <button class="rating-btn" onclick="setRating('eu', 'urgencia', 5, this)">5</button>
                            </div>
                        </div>

                        <div class="power-card" id="card-eu-relacionamento">
                            <div class="power-card-header">
                                <span class="power-icon">ü§ù</span>
                                <div>
                                    <div class="power-name">RELACIONAMENTO</div>
                                    <div class="power-desc">Hist√≥rico e conex√£o com ele</div>
                                </div>
                            </div>
                            <div class="rating-group">
                                <button class="rating-btn" onclick="setRating('eu', 'relacionamento', 1, this)">1</button>
                                <button class="rating-btn" onclick="setRating('eu', 'relacionamento', 2, this)">2</button>
                                <button class="rating-btn" onclick="setRating('eu', 'relacionamento', 3, this)">3</button>
                                <button class="rating-btn" onclick="setRating('eu', 'relacionamento', 4, this)">4</button>
                                <button class="rating-btn" onclick="setRating('eu', 'relacionamento', 5, this)">5</button>
                            </div>
                        </div>

                        <div class="power-card" id="card-eu-persistencia">
                            <div class="power-card-header">
                                <span class="power-icon">üí™</span>
                                <div>
                                    <div class="power-name">PERSIST√äNCIA</div>
                                    <div class="power-desc">Disposi√ß√£o para insistir</div>
                                </div>
                            </div>
                            <div class="rating-group">
                                <button class="rating-btn" onclick="setRating('eu', 'persistencia', 1, this)">1</button>
                                <button class="rating-btn" onclick="setRating('eu', 'persistencia', 2, this)">2</button>
                                <button class="rating-btn" onclick="setRating('eu', 'persistencia', 3, this)">3</button>
                                <button class="rating-btn" onclick="setRating('eu', 'persistencia', 4, this)">4</button>
                                <button class="rating-btn" onclick="setRating('eu', 'persistencia', 5, this)">5</button>
                            </div>
                        </div>
                    </div>

                    <!-- Coluna CLIENTE -->
                    <div class="power-column cliente-col">
                        <h3>üè¢ PODER DO CLIENTE</h3>

                        <div class="power-card" id="card-cliente-alternativas">
                            <div class="power-card-header">
                                <span class="power-icon">üéØ</span>
                                <div>
                                    <div class="power-name">ALTERNATIVAS</div>
                                    <div class="power-desc">Quantas op√ß√µes ele tem?</div>
                                </div>
                            </div>
                            <div class="rating-group">
                                <button class="rating-btn" onclick="setRating('cliente', 'alternativas', 1, this)">1</button>
                                <button class="rating-btn" onclick="setRating('cliente', 'alternativas', 2, this)">2</button>
                                <button class="rating-btn" onclick="setRating('cliente', 'alternativas', 3, this)">3</button>
                                <button class="rating-btn" onclick="setRating('cliente', 'alternativas', 4, this)">4</button>
                                <button class="rating-btn" onclick="setRating('cliente', 'alternativas', 5, this)">5</button>
                            </div>
                        </div>

                        <div class="power-card" id="card-cliente-informacao">
                            <div class="power-card-header">
                                <span class="power-icon">üìä</span>
                                <div>
                                    <div class="power-name">INFORMA√á√ÉO</div>
                                    <div class="power-desc">O quanto ele sabe sobre voc√™?</div>
                                </div>
                            </div>
                            <div class="rating-group">
                                <button class="rating-btn" onclick="setRating('cliente', 'informacao', 1, this)">1</button>
                                <button class="rating-btn" onclick="setRating('cliente', 'informacao', 2, this)">2</button>
                                <button class="rating-btn" onclick="setRating('cliente', 'informacao', 3, this)">3</button>
                                <button class="rating-btn" onclick="setRating('cliente', 'informacao', 4, this)">4</button>
                                <button class="rating-btn" onclick="setRating('cliente', 'informacao', 5, this)">5</button>
                            </div>
                        </div>

                        <div class="power-card" id="card-cliente-legitimidade">
                            <div class="power-card-header">
                                <span class="power-icon">üèÜ</span>
                                <div>
                                    <div class="power-name">LEGITIMIDADE</div>
                                    <div class="power-desc">Credibilidade e autoridade dele</div>
                                </div>
                            </div>
                            <div class="rating-group">
                                <button class="rating-btn" onclick="setRating('cliente', 'legitimidade', 1, this)">1</button>
                                <button class="rating-btn" onclick="setRating('cliente', 'legitimidade', 2, this)">2</button>
                                <button class="rating-btn" onclick="setRating('cliente', 'legitimidade', 3, this)">3</button>
                                <button class="rating-btn" onclick="setRating('cliente', 'legitimidade', 4, this)">4</button>
                                <button class="rating-btn" onclick="setRating('cliente', 'legitimidade', 5, this)">5</button>
                            </div>
                        </div>

                        <div class="power-card" id="card-cliente-urgencia">
                            <div class="power-card-header">
                                <span class="power-icon">‚è∞</span>
                                <div>
                                    <div class="power-name">URG√äNCIA (invertido)</div>
                                    <div class="power-desc">5 = ele n√£o tem pressa</div>
                                </div>
                            </div>
                            <div class="rating-group">
                                <button class="rating-btn" onclick="setRating('cliente', 'urgencia', 1, this)">1</button>
                                <button class="rating-btn" onclick="setRating('cliente', 'urgencia', 2, this)">2</button>
                                <button class="rating-btn" onclick="setRating('cliente', 'urgencia', 3, this)">3</button>
                                <button class="rating-btn" onclick="setRating('cliente', 'urgencia', 4, this)">4</button>
                                <button class="rating-btn" onclick="setRating('cliente', 'urgencia', 5, this)">5</button>
                            </div>
                        </div>

                        <div class="power-card" id="card-cliente-relacionamento">
                            <div class="power-card-header">
                                <span class="power-icon">ü§ù</span>
                                <div>
                                    <div class="power-name">RELACIONAMENTO</div>
                                    <div class="power-desc">Relacionamento dele com voc√™</div>
                                </div>
                            </div>
                            <div class="rating-group">
                                <button class="rating-btn" onclick="setRating('cliente', 'relacionamento', 1, this)">1</button>
                                <button class="rating-btn" onclick="setRating('cliente', 'relacionamento', 2, this)">2</button>
                                <button class="rating-btn" onclick="setRating('cliente', 'relacionamento', 3, this)">3</button>
                                <button class="rating-btn" onclick="setRating('cliente', 'relacionamento', 4, this)">4</button>
                                <button class="rating-btn" onclick="setRating('cliente', 'relacionamento', 5, this)">5</button>
                            </div>
                        </div>

                        <div class="power-card" id="card-cliente-persistencia">
                            <div class="power-card-header">
                                <span class="power-icon">üí™</span>
                                <div>
                                    <div class="power-name">PERSIST√äNCIA</div>
                                    <div class="power-desc">Disposi√ß√£o dele para insistir</div>
                                </div>
                            </div>
                            <div class="rating-group">
                                <button class="rating-btn" onclick="setRating('cliente', 'persistencia', 1, this)">1</button>
                                <button class="rating-btn" onclick="setRating('cliente', 'persistencia', 2, this)">2</button>
                                <button class="rating-btn" onclick="setRating('cliente', 'persistencia', 3, this)">3</button>
                                <button class="rating-btn" onclick="setRating('cliente', 'persistencia', 4, this)">4</button>
                                <button class="rating-btn" onclick="setRating('cliente', 'persistencia', 5, this)">5</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Comparison -->
                <div class="comparison-section">
                    <h3>üìä Comparativo de Poder</h3>

                    <div class="comparison-row">
                        <div class="comparison-label">üéØ Alternativas</div>
                        <div class="bar-container">
                            <div class="bar-fill eu-bar" id="bar-eu-alternativas" style="width: 0%;"></div>
                        </div>
                        <div class="bar-value eu-val" id="val-eu-alternativas">0</div>
                        <div class="bar-container">
                            <div class="bar-fill cliente-bar" id="bar-cliente-alternativas" style="width: 0%;"></div>
                        </div>
                        <div class="bar-value cliente-val" id="val-cliente-alternativas">0</div>
                    </div>

                    <div class="comparison-row">
                        <div class="comparison-label">üìä Informa√ß√£o</div>
                        <div class="bar-container">
                            <div class="bar-fill eu-bar" id="bar-eu-informacao" style="width: 0%;"></div>
                        </div>
                        <div class="bar-value eu-val" id="val-eu-informacao">0</div>
                        <div class="bar-container">
                            <div class="bar-fill cliente-bar" id="bar-cliente-informacao" style="width: 0%;"></div>
                        </div>
                        <div class="bar-value cliente-val" id="val-cliente-informacao">0</div>
                    </div>

                    <div class="comparison-row">
                        <div class="comparison-label">üèÜ Legitimidade</div>
                        <div class="bar-container">
                            <div class="bar-fill eu-bar" id="bar-eu-legitimidade" style="width: 0%;"></div>
                        </div>
                        <div class="bar-value eu-val" id="val-eu-legitimidade">0</div>
                        <div class="bar-container">
                            <div class="bar-fill cliente-bar" id="bar-cliente-legitimidade" style="width: 0%;"></div>
                        </div>
                        <div class="bar-value cliente-val" id="val-cliente-legitimidade">0</div>
                    </div>

                    <div class="comparison-row">
                        <div class="comparison-label">‚è∞ Urg√™ncia</div>
                        <div class="bar-container">
                            <div class="bar-fill eu-bar" id="bar-eu-urgencia" style="width: 0%;"></div>
                        </div>
                        <div class="bar-value eu-val" id="val-eu-urgencia">0</div>
                        <div class="bar-container">
                            <div class="bar-fill cliente-bar" id="bar-cliente-urgencia" style="width: 0%;"></div>
                        </div>
                        <div class="bar-value cliente-val" id="val-cliente-urgencia">0</div>
                    </div>

                    <div class="comparison-row">
                        <div class="comparison-label">ü§ù Relacionamento</div>
                        <div class="bar-container">
                            <div class="bar-fill eu-bar" id="bar-eu-relacionamento" style="width: 0%;"></div>
                        </div>
                        <div class="bar-value eu-val" id="val-eu-relacionamento">0</div>
                        <div class="bar-container">
                            <div class="bar-fill cliente-bar" id="bar-cliente-relacionamento" style="width: 0%;"></div>
                        </div>
                        <div class="bar-value cliente-val" id="val-cliente-relacionamento">0</div>
                    </div>

                    <div class="comparison-row">
                        <div class="comparison-label">üí™ Persist√™ncia</div>
                        <div class="bar-container">
                            <div class="bar-fill eu-bar" id="bar-eu-persistencia" style="width: 0%;"></div>
                        </div>
                        <div class="bar-value eu-val" id="val-eu-persistencia">0</div>
                        <div class="bar-container">
                            <div class="bar-fill cliente-bar" id="bar-cliente-persistencia" style="width: 0%;"></div>
                        </div>
                        <div class="bar-value cliente-val" id="val-cliente-persistencia">0</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Estrat√©gias -->
        <div class="card">
            <div class="card-header" style="background: linear-gradient(135deg, #e67e22, #f39c12);">
                <h2>üí° Estrat√©gias para Fortalecer seu Poder</h2>
            </div>
            <div class="card-body">
                <div class="strategy-section">
                    <h4>üéØ O que fazer para fortalecer suas fontes de poder?</h4>
                    <div class="form-group">
                        <label>üîÑ Como criar mais ALTERNATIVAS?</label>
                        <textarea id="estrategia-alternativas" placeholder="Ex: Prospectar outros 3 clientes antes da reuni√£o, ter op√ß√µes de backup..." oninput="updateProgress()"></textarea>
                    </div>
                    <div class="form-group">
                        <label>üìä Que INFORMA√á√ïES voc√™ precisa buscar?</label>
                        <textarea id="estrategia-informacao" placeholder="Ex: Pesquisar mais sobre o setor do cliente, descobrir quem s√£o os concorrentes..." oninput="updateProgress()"></textarea>
                    </div>
                    <div class="form-group">
                        <label>üèÜ Como demonstrar mais LEGITIMIDADE?</label>
                        <textarea id="estrategia-legitimidade" placeholder="Ex: Preparar cases de sucesso similares, mencionar certifica√ß√µes, trazer dados de mercado..." oninput="updateProgress()"></textarea>
                    </div>
                </div>

                <div class="reflection-box">
                    <h4>ü§î Perguntas para Reflex√£o</h4>
                    <ul class="reflection-questions">
                        <li>Qual fonte de poder voc√™ mais precisa desenvolver?</li>
                        <li>O cliente percebe o poder dele como maior ou menor do que realmente √©?</li>
                        <li>O que voc√™ pode fazer ANTES da pr√≥xima reuni√£o para mudar o equil√≠brio?</li>
                        <li>H√° alguma fonte de poder que voc√™ tem e n√£o est√° usando?</li>
                    </ul>
                </div>

                <div class="form-group">
                    <label>üìù Suas principais conclus√µes:</label>
                    <textarea id="conclusoes" style="min-height: 100px;" placeholder="Escreva seus insights sobre o equil√≠brio de poder desta negocia√ß√£o..." oninput="updateProgress()"></textarea>
                </div>

                <div class="form-group">
                    <label>üéØ Uma a√ß√£o concreta para fortalecer seu poder ESTA SEMANA:</label>
                    <textarea id="acaoSemana" placeholder="Ex: Vou ligar para 2 outros prospects antes da reuni√£o de quinta com esse cliente..." oninput="updateProgress()"></textarea>
                </div>

                <!-- Info impress√£o -->
                <div class="print-info">
                    <strong>Negocia√ß√£o para Vendas: M√©todo do Professor</strong><br>
                    Prof. Paulo H. Donassolo | Atividade 5.1 - Mapear Fontes de Poder<br>
                    Gerado em: <span id="print-data"></span>
                </div>

                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="limparFormulario()">üóëÔ∏è Limpar</button>
                    <button class="btn btn-export" onclick="imprimirPDF()">üìÑ Imprimir PDF</button>
                    <button class="btn btn-export" onclick="abrirModalExportacao()">üì§ Exportar JSON</button>
                    <button class="btn btn-primary" onclick="salvarLocal()">üíæ Salvar</button>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p><strong>Negocia√ß√£o para Vendas: M√©todo do Professor</strong></p>
            <p>Prof. Paulo H. Donassolo</p>
            <p style="font-size: 0.9em; margin-top: 10px;">üìö Se√ß√£o 5.1 - PODER</p>
        </div>
    </div>

    <!-- Modal Exporta√ß√£o -->
    <div class="modal-overlay" id="modalExportacao">
        <div class="modal">
            <div class="modal-header">
                <h3>üì§ Exportar Atividade (JSON)</h3>
                <button class="modal-close" onclick="fecharModal()">&times;</button>
            </div>
            <div class="modal-body">
                <p style="margin-bottom: 15px; color: var(--texto-medio);">
                    Copie o conte√∫do abaixo ou clique em "Baixar Arquivo" para salvar o JSON.
                </p>
                <textarea id="jsonOutput" readonly></textarea>
            </div>
            <div class="modal-footer">
                <button class="btn btn-copiar" onclick="copiarJSON()">üìã Copiar</button>
                <button class="btn btn-download" onclick="baixarJSON()">üíæ Baixar Arquivo</button>
            </div>
        </div>
    </div>

    <script>
        // Estado
        const STORAGE_KEY = 'anc_atividade_5_1_poder';
        let ratings = {
            eu: { alternativas: 0, informacao: 0, legitimidade: 0, urgencia: 0, relacionamento: 0, persistencia: 0 },
            cliente: { alternativas: 0, informacao: 0, legitimidade: 0, urgencia: 0, relacionamento: 0, persistencia: 0 }
        };
        let dadosExportacao = null;

        // Set rating
        function setRating(side, source, value, btn) {
            ratings[side][source] = value;

            // Atualizar bot√µes
            const card = document.getElementById(`card-${side}-${source}`);
            const buttons = card.querySelectorAll('.rating-btn');
            buttons.forEach((b, idx) => {
                b.classList.remove('active');
                if (idx + 1 === value) b.classList.add('active');
            });

            if (value > 0) card.classList.add('filled');

            updateScores();
            updateComparison();
            updateProgress();
            autoSave();
        }

        // Atualizar scores
        function updateScores() {
            const scoreEu = Object.values(ratings.eu).reduce((a, b) => a + b, 0);
            const scoreCliente = Object.values(ratings.cliente).reduce((a, b) => a + b, 0);
            const gap = scoreEu - scoreCliente;

            document.getElementById('score-eu').textContent = scoreEu;
            document.getElementById('score-cliente').textContent = scoreCliente;
            document.getElementById('score-gap').textContent = (gap > 0 ? '+' : '') + gap;

            // Cor do gap
            const gapBadge = document.querySelector('.stat-gap');
            if (gap > 0) {
                gapBadge.style.background = '#e8f8f5';
                gapBadge.style.color = '#1abc9c';
            } else if (gap < 0) {
                gapBadge.style.background = '#fdedec';
                gapBadge.style.color = '#e74c3c';
            } else {
                gapBadge.style.background = '#fef9e7';
                gapBadge.style.color = '#f39c12';
            }
        }

        // Atualizar compara√ß√£o
        function updateComparison() {
            const sources = ['alternativas', 'informacao', 'legitimidade', 'urgencia', 'relacionamento', 'persistencia'];

            sources.forEach(source => {
                const euVal = ratings.eu[source];
                const clienteVal = ratings.cliente[source];

                document.getElementById(`bar-eu-${source}`).style.width = (euVal * 20) + '%';
                document.getElementById(`bar-cliente-${source}`).style.width = (clienteVal * 20) + '%';
                document.getElementById(`val-eu-${source}`).textContent = euVal;
                document.getElementById(`val-cliente-${source}`).textContent = clienteVal;
            });
        }

        // Atualizar progresso
        function updateProgress() {
            let totalFields = 0;
            let filledFields = 0;

            // Campos de texto
            const textFields = ['negociador', 'cliente', 'valorEstimado', 'contexto', 
                               'estrategia-alternativas', 'estrategia-informacao', 'estrategia-legitimidade',
                               'conclusoes', 'acaoSemana'];
            textFields.forEach(id => {
                const el = document.getElementById(id);
                if (el) {
                    totalFields++;
                    if (el.value.trim().length > 2) filledFields++;
                }
            });

            // Ratings
            const allRatings = [...Object.values(ratings.eu), ...Object.values(ratings.cliente)];
            totalFields += allRatings.length;
            filledFields += allRatings.filter(r => r > 0).length;

            const progress = Math.min((filledFields / totalFields) * 100, 100);
            document.getElementById('progress').style.width = progress + '%';
        }

        // Mostrar status salvamento
        function mostrarStatusSalvamento() {
            const status = document.getElementById('statusSalvamento');
            status.classList.add('visivel');
            setTimeout(() => status.classList.remove('visivel'), 2000);
        }

        // Coletar dados
        function coletarDados() {
            return {
                _meta: {
                    tipo: "atividade_5_1_poder",
                    versao: "1.0",
                    exportadoEm: new Date().toISOString()
                },
                identificacao: {
                    negociador: document.getElementById('negociador').value,
                    cliente: document.getElementById('cliente').value,
                    dataNegociacao: document.getElementById('dataNegociacao').value,
                    valorEstimado: document.getElementById('valorEstimado').value,
                    contexto: document.getElementById('contexto').value
                },
                ratings: ratings,
                scores: {
                    eu: Object.values(ratings.eu).reduce((a, b) => a + b, 0),
                    cliente: Object.values(ratings.cliente).reduce((a, b) => a + b, 0)
                },
                estrategias: {
                    alternativas: document.getElementById('estrategia-alternativas').value,
                    informacao: document.getElementById('estrategia-informacao').value,
                    legitimidade: document.getElementById('estrategia-legitimidade').value
                },
                reflexao: {
                    conclusoes: document.getElementById('conclusoes').value,
                    acaoSemana: document.getElementById('acaoSemana').value
                }
            };
        }

        // Auto-save
        function autoSave() {
            const dados = coletarDados();
            localStorage.setItem(STORAGE_KEY, JSON.stringify(dados));
            mostrarStatusSalvamento();
        }

        // Salvar local
        function salvarLocal() {
            autoSave();
            alert('‚úÖ Atividade salva localmente com sucesso!');
        }

        // Carregar dados salvos
        function carregarDados() {
            const saved = localStorage.getItem(STORAGE_KEY);
            if (saved) {
                try {
                    const dados = JSON.parse(saved);

                    // Identifica√ß√£o
                    if (dados.identificacao) {
                        if (dados.identificacao.negociador) document.getElementById('negociador').value = dados.identificacao.negociador;
                        if (dados.identificacao.cliente) document.getElementById('cliente').value = dados.identificacao.cliente;
                        if (dados.identificacao.dataNegociacao) document.getElementById('dataNegociacao').value = dados.identificacao.dataNegociacao;
                        if (dados.identificacao.valorEstimado) document.getElementById('valorEstimado').value = dados.identificacao.valorEstimado;
                        if (dados.identificacao.contexto) document.getElementById('contexto').value = dados.identificacao.contexto;
                    }

                    // Ratings
                    if (dados.ratings) {
                        ratings = dados.ratings;
                        ['eu', 'cliente'].forEach(side => {
                            Object.keys(ratings[side]).forEach(source => {
                                if (ratings[side][source] > 0) {
                                    const card = document.getElementById(`card-${side}-${source}`);
                                    const buttons = card.querySelectorAll('.rating-btn');
                                    buttons[ratings[side][source] - 1].classList.add('active');
                                    card.classList.add('filled');
                                }
                            });
                        });
                    }

                    // Estrat√©gias
                    if (dados.estrategias) {
                        if (dados.estrategias.alternativas) document.getElementById('estrategia-alternativas').value = dados.estrategias.alternativas;
                        if (dados.estrategias.informacao) document.getElementById('estrategia-informacao').value = dados.estrategias.informacao;
                        if (dados.estrategias.legitimidade) document.getElementById('estrategia-legitimidade').value = dados.estrategias.legitimidade;
                    }

                    // Reflex√£o
                    if (dados.reflexao) {
                        if (dados.reflexao.conclusoes) document.getElementById('conclusoes').value = dados.reflexao.conclusoes;
                        if (dados.reflexao.acaoSemana) document.getElementById('acaoSemana').value = dados.reflexao.acaoSemana;
                    }

                    updateScores();
                    updateComparison();
                    updateProgress();
                } catch (e) {
                    console.error('Erro ao carregar dados:', e);
                }
            }
        }

        // Limpar formul√°rio
        function limparFormulario() {
            if (confirm('Tem certeza que deseja limpar todo o formul√°rio?')) {
                document.querySelectorAll('input[type="text"], textarea').forEach(el => el.value = '');
                document.querySelectorAll('select').forEach(el => el.selectedIndex = 0);

                ratings = {
                    eu: { alternativas: 0, informacao: 0, legitimidade: 0, urgencia: 0, relacionamento: 0, persistencia: 0 },
                    cliente: { alternativas: 0, informacao: 0, legitimidade: 0, urgencia: 0, relacionamento: 0, persistencia: 0 }
                };

                document.querySelectorAll('.rating-btn').forEach(btn => btn.classList.remove('active'));
                document.querySelectorAll('.power-card').forEach(card => card.classList.remove('filled'));

                localStorage.removeItem(STORAGE_KEY);
                updateScores();
                updateComparison();
                updateProgress();
            }
        }

        // Imprimir PDF
        function imprimirPDF() {
            document.getElementById('print-data').textContent = new Date().toLocaleDateString('pt-BR');
            window.print();
        }

        // Modal exporta√ß√£o
        function abrirModalExportacao() {
            dadosExportacao = coletarDados();
            document.getElementById('jsonOutput').value = JSON.stringify(dadosExportacao, null, 2);
            document.getElementById('modalExportacao').classList.add('active');
        }

        function fecharModal() {
            document.getElementById('modalExportacao').classList.remove('active');
        }

        function copiarJSON() {
            const textarea = document.getElementById('jsonOutput');
            textarea.select();
            textarea.setSelectionRange(0, 99999);
            try {
                navigator.clipboard.writeText(textarea.value).then(() => {
                    alert('JSON copiado para a √°rea de transfer√™ncia!');
                }).catch(() => {
                    document.execCommand('copy');
                    alert('JSON copiado para a √°rea de transfer√™ncia!');
                });
            } catch (err) {
                document.execCommand('copy');
                alert('JSON copiado para a √°rea de transfer√™ncia!');
            }
        }

        function baixarJSON() {
            try {
                const jsonStr = JSON.stringify(dadosExportacao, null, 2);
                const blob = new Blob([jsonStr], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                const cliente = document.getElementById('cliente').value.replace(/\s+/g, '_') || 'negociacao';
                a.download = `poder_${cliente}_${new Date().toISOString().slice(0,10)}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                fecharModal();
            } catch (err) {
                console.error('Erro ao baixar:', err);
                alert('Para baixar, copie o conte√∫do e cole em um arquivo .json');
            }
        }

        // Eventos
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') fecharModal();
        });

        document.getElementById('modalExportacao').addEventListener('click', function(e) {
            if (e.target === this) fecharModal();
        });

        // Auto-save em todos os campos
        document.querySelectorAll('input, textarea, select').forEach(el => {
            el.addEventListener('input', autoSave);
            el.addEventListener('change', autoSave);
        });

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            carregarDados();
            if (!document.getElementById('dataNegociacao').value) {
                document.getElementById('dataNegociacao').value = new Date().toISOString().split('T')[0];
            }
            updateProgress();
        });
    </script>
</body>
</html>
